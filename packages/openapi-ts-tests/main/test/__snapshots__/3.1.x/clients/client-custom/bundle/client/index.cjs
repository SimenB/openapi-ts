const e=async(e,t)=>{let n=typeof t==`function`?await t(e):t;if(n)return e.scheme===`bearer`?`Bearer ${n}`:e.scheme===`basic`?`Basic ${btoa(n)}`:n},t=(e,t,n)=>{typeof n==`string`||n instanceof Blob?e.append(t,n):e.append(t,JSON.stringify(n))},n=(e,t,n)=>{typeof n==`string`?e.append(t,n):e.append(t,JSON.stringify(n))},r={bodySerializer:e=>{let n=new FormData;return Object.entries(e).forEach(([e,r])=>{r!=null&&(Array.isArray(r)?r.forEach(r=>t(n,e,r)):t(n,e,r))}),n}},i={bodySerializer:e=>JSON.stringify(e,(e,t)=>typeof t==`bigint`?t.toString():t)},a={bodySerializer:e=>{let t=new URLSearchParams;return Object.entries(e).forEach(([e,r])=>{r!=null&&(Array.isArray(r)?r.forEach(r=>n(t,e,r)):n(t,e,r))}),t.toString()}},o=e=>{switch(e){case`label`:return`.`;case`matrix`:return`;`;case`simple`:return`,`;default:return`&`}},s=e=>{switch(e){case`form`:return`,`;case`pipeDelimited`:return`|`;case`spaceDelimited`:return`%20`;default:return`,`}},c=e=>{switch(e){case`label`:return`.`;case`matrix`:return`;`;case`simple`:return`,`;default:return`&`}},l=({allowReserved:e,explode:t,name:n,style:r,value:i})=>{if(!t){let t=(e?i:i.map(e=>encodeURIComponent(e))).join(s(r));switch(r){case`label`:return`.${t}`;case`matrix`:return`;${n}=${t}`;case`simple`:return t;default:return`${n}=${t}`}}let a=o(r),c=i.map(t=>r===`label`||r===`simple`?e?t:encodeURIComponent(t):u({allowReserved:e,name:n,value:t})).join(a);return r===`label`||r===`matrix`?a+c:c},u=({allowReserved:e,name:t,value:n})=>{if(n==null)return``;if(typeof n==`object`)throw Error("Deeply-nested arrays/objects arenâ€™t supported. Provide your own `querySerializer()` to handle these.");return`${t}=${e?n:encodeURIComponent(n)}`},d=({allowReserved:e,explode:t,name:n,style:r,value:i,valueOnly:a})=>{if(i instanceof Date)return a?i.toISOString():`${n}=${i.toISOString()}`;if(r!==`deepObject`&&!t){let t=[];Object.entries(i).forEach(([n,r])=>{t=[...t,n,e?r:encodeURIComponent(r)]});let a=t.join(`,`);switch(r){case`form`:return`${n}=${a}`;case`label`:return`.${a}`;case`matrix`:return`;${n}=${a}`;default:return a}}let o=c(r),s=Object.entries(i).map(([t,i])=>u({allowReserved:e,name:r===`deepObject`?`${n}[${t}]`:t,value:i})).join(o);return r===`label`||r===`matrix`?o+s:s},f=/\{[^{}]+\}/g,p=({path:e,url:t})=>{let n=t,r=t.match(f);if(r)for(let t of r){let r=!1,i=t.substring(1,t.length-1),a=`simple`;i.endsWith(`*`)&&(r=!0,i=i.substring(0,i.length-1)),i.startsWith(`.`)?(i=i.substring(1),a=`label`):i.startsWith(`;`)&&(i=i.substring(1),a=`matrix`);let o=e[i];if(o==null)continue;if(Array.isArray(o)){n=n.replace(t,l({explode:r,name:i,style:a,value:o}));continue}if(typeof o==`object`){n=n.replace(t,d({explode:r,name:i,style:a,value:o,valueOnly:!0}));continue}if(a===`matrix`){n=n.replace(t,`;${u({name:i,value:o})}`);continue}let s=encodeURIComponent(a===`label`?`.${o}`:o);n=n.replace(t,s)}return n},m=({allowReserved:e,array:t,object:n}={})=>r=>{let i=[];if(r&&typeof r==`object`)for(let a in r){let o=r[a];if(o!=null)if(Array.isArray(o)){let n=l({allowReserved:e,explode:!0,name:a,style:`form`,value:o,...t});n&&i.push(n)}else if(typeof o==`object`){let t=d({allowReserved:e,explode:!0,name:a,style:`deepObject`,value:o,...n});t&&i.push(t)}else{let t=u({allowReserved:e,name:a,value:o});t&&i.push(t)}}return i.join(`&`)},h=e=>{if(!e)return`stream`;let t=e.split(`;`)[0]?.trim();if(t){if(t.startsWith(`application/json`)||t.endsWith(`+json`))return`json`;if(t===`multipart/form-data`)return`formData`;if([`application/`,`audio/`,`image/`,`video/`].some(e=>t.startsWith(e)))return`blob`;if(t.startsWith(`text/`))return`text`}},g=(e,t)=>t?!!(e.headers.has(t)||e.query?.[t]||e.headers.get(`Cookie`)?.includes(`${t}=`)):!1,_=async({security:t,...n})=>{for(let r of t){if(g(n,r.name))continue;let t=await e(r,n.auth);if(!t)continue;let i=r.name??`Authorization`;switch(r.in){case`query`:n.query||={},n.query[i]=t;break;case`cookie`:n.headers.append(`Cookie`,`${i}=${t}`);break;case`header`:default:n.headers.set(i,t);break}}},v=e=>y({baseUrl:e.baseUrl,path:e.path,query:e.query,querySerializer:typeof e.querySerializer==`function`?e.querySerializer:m(e.querySerializer),url:e.url}),y=({baseUrl:e,path:t,query:n,querySerializer:r,url:i})=>{let a=i.startsWith(`/`)?i:`/${i}`,o=(e??``)+a;t&&(o=p({path:t,url:o}));let s=n?r(n):``;return s.startsWith(`?`)&&(s=s.substring(1)),s&&(o+=`?${s}`),o},b=(e,t)=>{let n={...e,...t};return n.baseUrl?.endsWith(`/`)&&(n.baseUrl=n.baseUrl.substring(0,n.baseUrl.length-1)),n.headers=x(e.headers,t.headers),n},x=(...e)=>{let t=new Headers;for(let n of e){if(!n||typeof n!=`object`)continue;let e=n instanceof Headers?n.entries():Object.entries(n);for(let[n,r]of e)if(r===null)t.delete(n);else if(Array.isArray(r))for(let e of r)t.append(n,e);else r!==void 0&&t.set(n,typeof r==`object`?JSON.stringify(r):r)}return t};var S=class{fns=[];clear(){this.fns=[]}eject(e){let t=this.getInterceptorIndex(e);this.fns[t]&&(this.fns[t]=null)}exists(e){let t=this.getInterceptorIndex(e);return!!this.fns[t]}getInterceptorIndex(e){return typeof e==`number`?this.fns[e]?e:-1:this.fns.indexOf(e)}update(e,t){let n=this.getInterceptorIndex(e);return this.fns[n]?(this.fns[n]=t,e):!1}use(e){return this.fns.push(e),this.fns.length-1}};const C=()=>({error:new S,request:new S,response:new S}),w=m({allowReserved:!1,array:{explode:!0,style:`form`},object:{explode:!0,style:`deepObject`}}),T={"Content-Type":`application/json`},E=(e={})=>({...i,headers:T,parseAs:`auto`,querySerializer:w,...e}),D=(e={})=>{let t=b(E(),e),n=()=>({...t}),r=e=>(t=b(t,e),n()),i=C(),a=async e=>{let n={...t,...e,fetch:e.fetch??t.fetch??globalThis.fetch,headers:x(t.headers,e.headers)};n.security&&await _({...n,security:n.security}),n.requestValidator&&await n.requestValidator(n),n.body&&n.bodySerializer&&(n.body=n.bodySerializer(n.body)),(n.body===void 0||n.body===``)&&n.headers.delete(`Content-Type`);let r=v(n),a={redirect:`follow`,...n},o=new Request(r,a);for(let e of i.request.fns)e&&(o=await e(o,n));let s=n.fetch,c=await s(o);for(let e of i.response.fns)e&&(c=await e(c,o,n));let l={request:o,response:c};if(c.ok){if(c.status===204||c.headers.get(`Content-Length`)===`0`)return{data:{},...l};let e=(n.parseAs===`auto`?h(c.headers.get(`Content-Type`)):n.parseAs)??`json`,t;switch(e){case`arrayBuffer`:case`blob`:case`formData`:case`json`:case`text`:t=await c[e]();break;case`stream`:return{data:c.body,...l}}return e===`json`&&(n.responseValidator&&await n.responseValidator(t),n.responseTransformer&&(t=await n.responseTransformer(t))),{data:t,...l}}let u=await c.text();try{u=JSON.parse(u)}catch{}let d=u;for(let e of i.error.fns)e&&(d=await e(u,c,o,n));if(d||={},n.throwOnError)throw d;return{error:d,...l}};return{buildUrl:v,connect:e=>a({...e,method:`CONNECT`}),delete:e=>a({...e,method:`DELETE`}),get:e=>a({...e,method:`GET`}),getConfig:n,head:e=>a({...e,method:`HEAD`}),interceptors:i,options:e=>a({...e,method:`OPTIONS`}),patch:e=>a({...e,method:`PATCH`}),post:e=>a({...e,method:`POST`}),put:e=>a({...e,method:`PUT`}),request:a,setConfig:r,trace:e=>a({...e,method:`TRACE`})}},O=Object.entries({$body_:`body`,$headers_:`headers`,$path_:`path`,$query_:`query`}),k=(e,t)=>{t||=new Map;for(let n of e)`in`in n?n.key&&t.set(n.key,{in:n.in,map:n.map}):n.args&&k(n.args,t);return t},A=e=>{for(let[t,n]of Object.entries(e))n&&typeof n==`object`&&!Object.keys(n).length&&delete e[t]},j=(e,t)=>{let n={body:{},headers:{},path:{},query:{}},r=k(t),i;for(let[a,o]of e.entries())if(t[a]&&(i=t[a]),i)if(`in`in i)if(i.key){let e=r.get(i.key),t=e.map||i.key;n[e.in][t]=o}else n.body=o;else for(let[e,t]of Object.entries(o??{})){let a=r.get(e);if(a){let r=a.map||e;n[a.in][r]=t}else{let r=O.find(([t])=>e.startsWith(t));if(r){let[i,a]=r;n[a][e.slice(i.length)]=t}else for(let[r,a]of Object.entries(i.allowExtra??{}))if(a){n[r][e]=t;break}}}return A(n),n};exports.buildClientParams=j,exports.createClient=D,exports.createConfig=E,exports.formDataBodySerializer=r,exports.jsonBodySerializer=i,exports.urlSearchParamsBodySerializer=a;
//# sourceMappingURL=index.cjs.map